<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OSINT Investigation Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="navbar">
    <div class="logo">
      <svg viewBox="0 0 24 24">
        <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
      </svg>
      <span>OSINT Investigation Dashboard</span>
    </div>
    <div class="actions">
      <button id="export-btn" class="btn btn-primary">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="7 10 12 15 17 10"></polyline>
          <line x1="12" y1="15" x2="12" y2="3"></line>
        </svg>
        Export .itsy
      </button>
      <label for="import-file" class="btn btn-secondary">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="17 8 12 3 7 8"></polyline>
          <line x1="12" y1="3" x2="12" y2="15"></line>
        </svg>
        Import .itsy
      </label>
      <input type="file" id="import-file" class="file-input" accept=".itsy">
      <button id="api-store-btn" class="btn btn-secondary">API Store</button>
      <div class="api-store" id="api-store">
        <h2 class="api-store-title">API Store</h2>
        <div class="form-group">
          <label class="form-label" for="api-key-1">API Key 1</label>
          <input type="text" id="api-key-1" class="api-input" placeholder="Enter API Key">
        </div>
        <div class="form-group">
          <label class="form-label" for="api-key-2">API Key 2</label>
          <input type="text" id="api-key-2" class="api-input" placeholder="Enter API Key">
        </div>
      </div>
    </div>
  </header>

  <main class="main-container">
    <aside class="sidebar">
      <h2 class="sidebar-title">Widgets</h2>
      <div id="widget-username" class="widget-item" draggable="true" data-type="USERNAME">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--username-color)">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
        </svg>
        <span class="widget-label">Username</span>
      </div>
      <div id="widget-name" class="widget-item" draggable="true" data-type="NAME">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--name-color)">
          <path d="M16 7a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"></path>
          <path d="M12 14c-4.97 0-9 2.015-9 4.5V20h18v-1.5c0-2.485-4.03-4.5-9-4.5z"></path>
        </svg>
        <span class="widget-label">Name</span>
      </div>
      <div id="widget-email" class="widget-item" draggable="true" data-type="EMAIL">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--email-color)">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
          <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
        <span class="widget-label">Email</span>
      </div>
      <div id="widget-social" class="widget-item" draggable="true" data-type="SOCIAL_MEDIA">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--social-media-color)">
          <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
        </svg>
        <span class="widget-label">Social Media ID</span>
      </div>
      <div id="widget-encryption" class="widget-item" draggable="true" data-type="ENCRYPTION_KEY">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--encryption-key-color)">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          <circle cx="12" cy="16" r="1"></circle>
        </svg>
        <span class="widget-label">Encryption Key</span>
      </div>
      <div id="widget-password" class="widget-item" draggable="true" data-type="PASSWORD">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--password-color)">
          <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
          <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
          <line x1="12" y1="15" x2="12" y2="17"></line>
        </svg>
        <span class="widget-label">Password</span>
      </div>
      <div id="widget-crypto" class="widget-item" draggable="true" data-type="CRYPTO_WALLET">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--crypto-wallet-color)">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"></path>
          <circle cx="15" cy="12" r="2"></circle>
        </svg>
        <span class="widget-label">Crypto Wallet</span>
      </div>
      <div id="widget-ip" class="widget-item" draggable="true" data-type="IP_ADDRESS">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--ip-address-color)">
          <path d="M12 2v2m0 16v2m10-10h-2M2 12h2m15.5-6.5L17 8m-10 10L4.5 15.5m13 0L20 18m-16-10L6.5 5.5"></path>
          <circle cx="12" cy="12" r="3"></circle>
        </svg>
        <span class="widget-label">IP Address</span>
      </div>
      <div id="widget-domain" class="widget-item" draggable="true" data-type="DOMAIN">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--domain-color)">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          <path d="M9 12h6m-3-3v6"></path>
        </svg>
        <span class="widget-label">Domain</span>
      </div>
      <div id="widget-onion" class="widget-item" draggable="true" data-type="ONION_SITE">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--onion-site-color)">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"></path>
        </svg>
        <span class="widget-label">Onion Site</span>
      </div>
      <div id="widget-location" class="widget-item" draggable="true" data-type="LOCATION">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--location-color)">
          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
          <circle cx="12" cy="10" r="3"></circle>
        </svg>
        <span class="widget-label">Location</span>
      </div>
      <div id="widget-image" class="widget-item" draggable="true" data-type="IMAGE">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--image-color)">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <circle cx="8.5" cy="8.5" r="1.5"></circle>
          <polyline points="21 15 16 10 5 21"></polyline>
        </svg>
        <span class="widget-label">Image</span>
      </div>
      <div id="widget-custom" class="widget-item" draggable="true" data-type="CUSTOM_FIELD">
        <svg class="widget-icon" viewBox="0 0 24 24" stroke="var(--custom-field-color)">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="9" y1="9" x2="15" y2="15"></line>
          <line x1="15" y1="9" x2="9" y2="15"></line>
        </svg>
        <span class="widget-label">Custom Field</span>
      </div>
    </aside>

    <div class="workspace-container">
      <div class="workspace" id="workspace">
        <svg class="workspace-canvas" id="canvas">
          <defs>
            <marker id="arrowhead" 
                    markerWidth="10" 
                    markerHeight="7" 
                    refX="5" 
                    refY="3.5" 
                    orient="auto"
                    markerUnits="strokeWidth">
              <polygon points="0 0, 10 3.5, 0 7" fill="var(--text-secondary)" />
            </marker>
          </defs>
          <g class="edges" id="edges"></g>
        </svg>
        <div id="nodes-container"></div>
      </div>

      <div class="zoom-controls">
        <button id="select-tool" class="tool-btn active" title="Select Tool">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z"></path>
          </svg>
        </button>
        <button id="connect-tool" class="tool-btn" title="Connect Tool">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
          </svg>
        </button>
        <div class="divider"></div>
        <button id="zoom-in" class="zoom-btn" title="Zoom In">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="11" y1="8" x2="11" y2="14"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <button id="zoom-out" class="zoom-btn" title="Zoom Out">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
        </button>
        <button id="settings-btn" class="tool-btn" title="Settings">
          <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
          </svg>
        </button>
      </div>

      <aside class="properties-panel" id="properties-panel">
        <div class="properties-header">
          <svg id="property-icon" class="widget-icon" viewBox="0 0 24 24"></svg>
          <h2 class="properties-title" id="property-title">Node Properties</h2>
        </div>
        <div class="form-group">
          <label class="form-label" for="property-type">Type</label>
          <input type="text" id="property-type" class="form-input" disabled>
        </div>
        <div class="form-group">
          <label class="form-label" for="property-label">Label</label>
          <input type="text" id="property-label" class="form-input">
        </div>
        <div class="form-group">
          <label class="form-label" for="property-value">Value</label>
          <input type="text" id="property-value" class="form-input">
          <span id="ip-warning" class="warning" style="display: none;">
            <svg viewBox="0 0 24 24" width="12" height="12" fill="none" stroke="#ffcc00" stroke-width="2">
              <path d="M12 2L2 19h20L12 2zm0 4v8m0 4h.01"></path>
            </svg>
            Invalid IP Address
          </span>
        </div>
        <div class="form-group" id="confidence-group">
          <label class="form-label" for="property-confidence">Confidence</label>
          <input type="range" id="property-confidence" min="1" max="4" value="3" class="form-slider">
          <span id="confidence-label" class="form-label">Likely Correct</span>
        </div>
        <div class="form-group" id="platform-group" style="display: none;">
          <label class="form-label" for="property-platform">Platform</label>
          <select id="property-platform" class="form-select">
            <!-- Options populated dynamically -->
          </select>
        </div>
        <div class="form-group">
          <label class="form-label" for="property-notes">Notes</label>
          <textarea id="property-notes" class="form-textarea"></textarea>
        </div>
      </aside>

      <div class="edge-menu" id="edge-menu">
        <button class="edge-menu-btn" id="edge-delete">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Delete
        </button>
        <button class="edge-menu-btn" id="edge-reverse">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
          </svg>
          Reverse
        </button>
      </div>
    </div>
  </main>

  <footer class="status-bar">
    <div class="status-metrics">
      <span id="nodes-count">0 Nodes</span>
      <span id="edges-count">0 Connections</span>
    </div>
    <div id="zoom-level">Zoom: 100%</div>
  </footer>

  <div class="delete-prompt" id="delete-prompt">
    <h3 class="delete-prompt-header">Delete Confirmation</h3>
    <p>Are you sure you want to delete this item?</p>
    <div class="delete-prompt-buttons">
      <button class="delete-prompt-btn cancel" id="delete-cancel">Cancel</button>
      <button class="delete-prompt-btn delete" id="delete-confirm">Delete</button>
    </div>
  </div>

  <script src="icons.js"></script>
  <script src="utils.js"></script>
  <script src="nodes.js"></script>
  <script src="edges.js"></script>
  <script src="ui.js"></script>
  <script src="main.js"></script>
</body>
</html>